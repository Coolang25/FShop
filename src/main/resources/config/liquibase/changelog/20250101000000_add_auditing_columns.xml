<?xml version="1.0" encoding="utf-8"?>
<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-latest.xsd
                        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

    <changeSet id="20250101000000-1" author="jhipster">
        <comment>Remove old timestamp columns and add auditing columns to all entities</comment>

        <!-- Remove old timestamp columns from all tables -->
        <dropColumn tableName="product_reviews" columnName="created_at"/>
        <dropColumn tableName="product_reviews" columnName="updated_at"/>
        <dropColumn tableName="carts" columnName="created_at"/>
        <dropColumn tableName="carts" columnName="updated_at"/>
        <dropColumn tableName="payments" columnName="created_at"/>

        <!-- Add auditing columns to categories table -->
        <addColumn tableName="categories">
            <column name="created_by" type="varchar(50)" defaultValue="system">
                <constraints nullable="false"/>
            </column>
            <column name="created_date" type="timestamp">
            </column>
            <column name="last_modified_by" type="varchar(50)"/>
            <column name="last_modified_date" type="timestamp"/>
        </addColumn>

        <!-- Add auditing columns to products table -->
        <addColumn tableName="products">
            <column name="created_by" type="varchar(50)" defaultValue="system">
                <constraints nullable="false"/>
            </column>
            <column name="created_date" type="timestamp">
                <constraints nullable="false"/>
            </column>
            <column name="last_modified_by" type="varchar(50)"/>
            <column name="last_modified_date" type="timestamp"/>
        </addColumn>

        <!-- Add auditing columns to product_images table -->
        <addColumn tableName="product_images">
            <column name="created_by" type="varchar(50)" defaultValue="system">
                <constraints nullable="false"/>
            </column>
            <column name="created_date" type="timestamp">
                <constraints nullable="false"/>
            </column>
            <column name="last_modified_by" type="varchar(50)"/>
            <column name="last_modified_date" type="timestamp"/>
        </addColumn>

        <!-- Add auditing columns to product_attributes table -->
        <addColumn tableName="product_attributes">
            <column name="created_by" type="varchar(50)" defaultValue="system">
                <constraints nullable="false"/>
            </column>
            <column name="created_date" type="timestamp">
                <constraints nullable="false"/>
            </column>
            <column name="last_modified_by" type="varchar(50)"/>
            <column name="last_modified_date" type="timestamp"/>
        </addColumn>

        <!-- Add auditing columns to product_attribute_values table -->
        <addColumn tableName="product_attribute_values">
            <column name="created_by" type="varchar(50)" defaultValue="system">
                <constraints nullable="false"/>
            </column>
            <column name="created_date" type="timestamp">
                <constraints nullable="false"/>
            </column>
            <column name="last_modified_by" type="varchar(50)"/>
            <column name="last_modified_date" type="timestamp"/>
        </addColumn>

        <!-- Add auditing columns to product_variants table -->
        <addColumn tableName="product_variants">
            <column name="created_by" type="varchar(50)" defaultValue="system">
                <constraints nullable="false"/>
            </column>
            <column name="created_date" type="timestamp">
                <constraints nullable="false"/>
            </column>
            <column name="last_modified_by" type="varchar(50)"/>
            <column name="last_modified_date" type="timestamp"/>
        </addColumn>

        <!-- Add auditing columns to product_reviews table -->
        <addColumn tableName="product_reviews">
            <column name="created_by" type="varchar(50)" defaultValue="system">
                <constraints nullable="false"/>
            </column>
            <column name="created_date" type="timestamp">
                <constraints nullable="false"/>
            </column>
            <column name="last_modified_by" type="varchar(50)"/>
            <column name="last_modified_date" type="timestamp"/>
        </addColumn>

        <!-- Add auditing columns to carts table -->
        <addColumn tableName="carts">
            <column name="created_by" type="varchar(50)" defaultValue="system">
                <constraints nullable="false"/>
            </column>
            <column name="created_date" type="timestamp">
                <constraints nullable="false"/>
            </column>
            <column name="last_modified_by" type="varchar(50)"/>
            <column name="last_modified_date" type="timestamp"/>
        </addColumn>

        <!-- Add auditing columns to cart_items table -->
        <addColumn tableName="cart_items">
            <column name="created_by" type="varchar(50)" defaultValue="system">
                <constraints nullable="false"/>
            </column>
            <column name="created_date" type="timestamp">
                <constraints nullable="false"/>
            </column>
            <column name="last_modified_by" type="varchar(50)"/>
            <column name="last_modified_date" type="timestamp"/>
        </addColumn>

        <!-- Add auditing columns to shop_orders table -->
        <addColumn tableName="shop_orders">
            <column name="created_by" type="varchar(50)" defaultValue="system">
                <constraints nullable="false"/>
            </column>
            <column name="created_date" type="timestamp">
                <constraints nullable="false"/>
            </column>
            <column name="last_modified_by" type="varchar(50)"/>
            <column name="last_modified_date" type="timestamp"/>
        </addColumn>

        <!-- Add auditing columns to order_items table -->
        <addColumn tableName="order_items">
            <column name="created_by" type="varchar(50)" defaultValue="system">
                <constraints nullable="false"/>
            </column>
            <column name="created_date" type="timestamp">
                <constraints nullable="false"/>
            </column>
            <column name="last_modified_by" type="varchar(50)"/>
            <column name="last_modified_date" type="timestamp"/>
        </addColumn>

        <!-- Add auditing columns to payments table -->
        <addColumn tableName="payments">
            <column name="created_by" type="varchar(50)" defaultValue="system">
                <constraints nullable="false"/>
            </column>
            <column name="created_date" type="timestamp">
                <constraints nullable="false"/>
            </column>
            <column name="last_modified_by" type="varchar(50)"/>
            <column name="last_modified_date" type="timestamp"/>
        </addColumn>

        <!-- Add auditing columns to chatbot_logs table -->
        <addColumn tableName="chatbot_logs">
            <column name="created_by" type="varchar(50)" defaultValue="system">
                <constraints nullable="false"/>
            </column>
            <column name="created_date" type="timestamp">
                <constraints nullable="false"/>
            </column>
            <column name="last_modified_by" type="varchar(50)"/>
            <column name="last_modified_date" type="timestamp"/>
        </addColumn>

        <!-- Add auditing columns to inventory_transactions table -->
        <addColumn tableName="inventory_transactions">
            <column name="created_by" type="varchar(50)" defaultValue="system">
                <constraints nullable="false"/>
            </column>
            <column name="created_date" type="timestamp">
                <constraints nullable="false"/>
            </column>
            <column name="last_modified_by" type="varchar(50)"/>
            <column name="last_modified_date" type="timestamp"/>
        </addColumn>

    </changeSet>

</databaseChangeLog>
